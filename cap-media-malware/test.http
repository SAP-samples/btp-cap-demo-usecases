@xsuaaHostname = <<credentials.url - field from xsuaa section of default-env.json>>
@xsuaaClient = <<credentials.clientid - field from xsuaa section of default-env.json>>
@xsuaaSecret = <<credentials.clientsecret - field from xsuaa section of default-env.json>>
@host = <<service url after deployment>>
@protocol = https


### Request-1 Get xsuaa token
#==================================================================#
# @name getXsuaaToken

POST {{xsuaaHostname}}/oauth/token
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Authorization: Basic {{xsuaaClient}}:{{xsuaaSecret}}

client_id={{xsuaaClient}}
&client_secret={{xsuaaSecret}}
&grant_type=client_credentials


### Store access token 
@access_token = {{getXsuaaToken.response.body.$.access_token}}

### Request-2 Create entry in MediaFiles
#==================================================================#
# @name postMediaEntry
POST {{protocol}}://{{host}}/media/MediaFiles
Authorization: Bearer {{access_token}}
Content-Type: application/json
 
{
    "type": "text/plain",
    "filename": "malware.test.txt"
}
### Request-3 Update file with Malware
#==================================================================#
PUT {{protocol}}://{{host}}/media/MediaFiles({{postMediaEntry.response.body.$.ID}})/content
Authorization: Bearer {{access_token}}
Content-Type: text/plain

< ./srv/malware.test.txt

### Request-4 PUT Request
#==================================================================#
PUT {{protocol}}://{{host}}/media/MediaFiles({{postMediaEntry.response.body.$.ID}})/content
Authorization: Bearer {{access_token}}
Content-Type: text/plain

< ./srv/test.txt


### Request-5 Read file Content
#==================================================================#
GET {{protocol}}://{{host}}/media/MediaFiles({{postMediaEntry.response.body.$.ID}})/content
Authorization: Bearer {{access_token}}
